---
title: "Gather.townの会議を収録(録画・録音)する for mac"
emoji: "🐤"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ['gathertown', 'OBS', 'BlackHole']
published: false
---

## この記事について

デジタル空間でのコミュニケーションを促す Gather.Town というサービスにおいて、会議を録画・録音する方法について紹介する記事です。

https://www.gather.town/

zoomなどの会議ツールでは録画機能を備えており、特別な設定やソフトを用意しなくても簡単に録画が可能です。

しかし、Gather.Town は会議専用ツールではないからか録画機能が付帯していません。

classmethodさんが完璧な記事を出されていますが、ハマりどころがいくつかあったため記事にしました。

https://dev.classmethod.jp/articles/gather-town-recording-with-obs-studio/

## 作業の流れ

最初に大まかにやることの流れを確認します。
詳しい内容は後述します。

1. 仮想オーディオドライバのインストール
[BlackHole](https://existential.audio/blackhole/)をインストールします
2. 複数出力装置の作成
macのアプリケーションランチャからAudio MIDIを起動して、内蔵出力・仮想オーディオの2つから音を出力する[「複数出力装置」](https://support.apple.com/ja-jp/guide/audio-midi-setup/ams7c093f372/mac)を作成します
3. gatherの音声出力先を複数出力装置に設定
gatherログイン時に、3で作成した複数出力装置を出力先に設定します
4. 収録アプリのインストール・設定
[OBS Studio](https://obsproject.com/ja/download)をインストールします
5. 収録(録画・録音)する

**仮想オーディオがなぜ必要なのか**

OBS Studioは録画・録音が可能ですが、仮想オーディオがないと録音する際にイヤホンやスピーカー経由でマイクから音を拾う必要があるため、音質が顕著に悪化します。

また、多くのアプリケーションにおいては出力先を1つしか選べず、gatherも例外ではないため仮想オーディオのみを出力先とすると内蔵出力からは音が聞こえないため会議に参加できません。

そのため、仮想オーディオと内臓出力(スピーカー)の２つから音が出るようにAudio MIDIでひとまとめにしたものをgatherの出力先として設定して、録音も会議への参加も可能にしています。

### 1. 仮想オーディオドライバのインストール

classmethodさんの記事ではSoundFlower+LadioCastというツールが紹介されていましたが、[Monterey以降のOSで動作しない](https://hideshigelog.com/obs-studiomacoto#:~:text=%E6%B3%A8%E6%84%8F%E7%82%B9%EF%BC%9AM1Mac%E3%82%84macOS%20Monterey%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E3%80%81%E4%BB%AE%E6%83%B3%E3%82%AA%E3%83%BC%E3%83%87%E3%82%A3%E3%82%AA%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9%E3%81%AESoundFlower%E3%81%8C%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%9B%E3%82%93%E3%81%AE%E3%81%A7%E3%80%81Blackhole%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%97%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84%E3%80%82)というソースを見つけたため [BlackHole](https://existential.audio/blackhole/)を利用しました。  
(私のPCがMontereyでした)

`I can't afford to donate` クリックすると氏名・メールアドレスの入力欄が出るので入力して `Send Link to Download` をクリックします。  
(もちろん有志で公開されているツールのため、この記事に少なからず救われた感動したという方はぜひBlackHoleに寄付をお願いします🙏)

![blackhole home](/images/obs-blackhole/blackhole_1.png)

メールに届いたダウンロードリンクを開いて、 `Download > BlackHole 2ch` をクリックしてインストーラをダウンロードします。  
(ハードに詳しくないためnchのnの意味は分かりませんが、恐らく音声ソースのスピーカー数だと勝手に想定しています)

![blackhole download](/images/obs-blackhole/blackhole_2.png)

あとはインストーラーをクリック起動して指示通りにインストールを完了させればmacの音声出力先に `BlackHole 2ch` が追加されます。

### 2. 複数出力装置の作成

macの[Launchpad](https://support.apple.com/ja-jp/guide/mac-help/mh35840/mac)から `Audio MIDI` を検索して起動します。

右下の＋アイコンから「複数出力装置」を追加して、追加された複数出力装置をクリックしてパネル右の各オーディオ装置の「使用」にチェックを入れて有効化します。

![Audio MIDI](/images/obs-blackhole/midi.png)

これで各アプリ利用時に出力先として複数出力装置を選択すると、仮想オーディオと内臓出力から音声が出るようになりました。

### 3. gatherの音声出力先を複数出力装置に設定

gatherでスペースに入る際にスピーカーを選ぶ部分があるため、先程作成した「複数出力装置」を選択します。

### 4. 録画・録音アプリのインストール・設定

インストール・設定中に `"OBS"から〜にアクセスしようとしています` のようなダイアログが表示されますので、すべて許可します。 

システム環境設定の変更を求められるダイアログでは `システム環境設定 > セキュリティとプライバシー > プライバシー` のカメラ・マイク(OSによっては画面収録・音声収録かも？)2つの許可アプリケーション欄から `OBS.app` にチェックを付けます。

![OBS セキュリティ許可](/images/obs-blackhole/obs_1.png)


#### 4-1. インストール

[OBS Studio](https://obsproject.com/ja/download)をダウンロードします。

M1/M2の場合は `ダウンロード インストーラ (arm64/Apple Silicon)` それ以外は `ダウンロード インストーラ (x86_64/Intel)` をクリックしてください。

初期設定のダイアログが開きますが、最初は全て初期値で問題ありません。

#### 4-2. 設定

ソース(収録対象アプリ)、音声ミキサー(これは必須ではありません)の設定を行います。

注意点として、OBSとgatherのブラウザは同じ[操作スペース(仮想デスクトップ)](https://support.apple.com/ja-jp/guide/mac-help/mh14112/mac)内で開いてください。

設定・収録時にOBSとブラウザが同じ操作スペース内に存在しないとソースが選択できなかったり録画がうまくいかなくなります。
(恐らく、ブラウザが非表示時に描画を停止することが原因)

マルチディスプレイで個別に表示する場合はうまくいくかもしれません。

##### ソースの設定

1. 画面下の「ソース」欄の左下＋アイコンをクリックして `ウィンドウキャプチャ` を追加します。

2. 追加されたウィンドウキャプチャをダブルクリックします

3. ウィンドウにgatherの画面を選択します。  
chromeの場合は `[Google Chrome.app] gatherスペース名` のような名称になります。

![OBS ソースの設定](/images/obs-blackhole/obs_2.png)

##### 音声ミキサーの設定

こちらの設定は任意です。  
classmethodさんの記事でも紹介されていますが、音声のノイズを低減する方法です。

1. 音声ミキサー欄のデスクトップ音声の設定アイコンをクリック

2. 設定ウィンドウ左下の＋アイコンをクリック

3. `ノイズ抑制` を選択・追加

![OBS 音声ミキサーの設定](/images/obs-blackhole/obs_3.png)

### 5. 収録(録画・録音)する

画面右下の `録画開始` ボタンをクリックすると収録が始まります。  
収録開始後は `録画終了` というラベルに切り替わりますので、終了時にクリックします。

なお、動画が処理されている間 `録画終了中...` というラベルが表示され、録画時間などによって長時間かかりますがこの間にクリックすると **動画が壊れる** ため注意が必要です。  

![OBS 収録](/images/obs-blackhole/obs_4.png)
